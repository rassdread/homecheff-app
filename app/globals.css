@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fadeIn {
    animation: fadeIn 0.3s ease-out;
  }

  @keyframes slideUp {
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  
  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }

  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Global overflow protection for mobile */
  .overflow-wrap-anywhere {
    overflow-wrap: anywhere;
    word-break: break-word;
  }

  /* Ensure video controls are always visible for non-logged users */
  video[controls] {
    cursor: pointer;
  }

  video[controls]:hover::-webkit-media-controls-panel,
  video[controls]:focus::-webkit-media-controls-panel {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Keep controls visible on touch devices */
  video[controls]:active::-webkit-media-controls-panel {
    display: flex !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* For Firefox and other browsers */
  video[controls]:hover,
  video[controls]:focus,
  video[controls]:active {
    cursor: pointer;
  }

  .word-break-break-all {
    word-break: break-all;
  }

  /* Safari backdrop-blur fallback - enhanced opacity for better visibility */
  @supports not (backdrop-filter: blur(1px)) {
    /* For elements with white/20 (20% opacity) - increase to 85% for visibility */
    .bg-white\/20.backdrop-blur-sm,
    .bg-white\/20.backdrop-blur {
      background-color: rgba(255, 255, 255, 0.85) !important;
    }
    
    /* For elements with white/10 (10% opacity) - increase to 70% */
    .bg-white\/10.backdrop-blur-sm,
    .bg-white\/10.backdrop-blur {
      background-color: rgba(255, 255, 255, 0.70) !important;
    }
    
    /* For elements with white/15 (15% opacity) - increase to 75% */
    .bg-white\/15.backdrop-blur-sm,
    .bg-white\/15.backdrop-blur {
      background-color: rgba(255, 255, 255, 0.75) !important;
    }
    
    /* Generic fallback for any backdrop-blur */
    .backdrop-blur-sm,
    .backdrop-blur {
      background-color: rgba(255, 255, 255, 0.80);
    }
  }

  /* Safari-specific fixes for better rendering */
  @media screen and (-webkit-min-device-pixel-ratio: 0) {
    /* Safari font rendering improvements */
    body {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    
    /* Safari gradient fixes - alleen voor background gradients, niet voor text gradients */
    .bg-gradient-to-br:not(.bg-clip-text),
    .bg-gradient-to-r:not(.bg-clip-text),
    .bg-gradient-to-l:not(.bg-clip-text),
    .bg-gradient-to-t:not(.bg-gradient-to-br):not(.bg-clip-text) {
      -webkit-background-clip: padding-box;
      background-clip: padding-box;
    }
    
    /* Safari transform fixes for better performance */
    .transform {
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
    }
  }

  /* Cross-browser compatibility for modern CSS features */
  @supports (display: grid) {
    /* Grid is supported - no fallback needed */
  }
  
  /* Firefox specific fixes */
  @-moz-document url-prefix() {
    /* Firefox backdrop-blur support is limited, use solid background */
    @supports not (backdrop-filter: blur(1px)) {
      .backdrop-blur-sm,
      .backdrop-blur {
        background-color: rgba(255, 255, 255, 0.85);
      }
    }
  }
}

/* ===== HomeCheff: Global tokens ===== */
:root {
  --background: #F6F8FA;
  --foreground: #171717;
  --primary: #006D52;
  --secondary: #0067B1;
  --accent: #FFD600;
  --success: #00C853;
  --error: #D32F2F;
  --info: #0288D1;

  /* Spacing tokens (not enforced globally) */
  --space-1: 0.5rem;   /* 8px */
  --space-2: 0.75rem;  /* 12px */
  --space-3: 1rem;     /* 16px */
  --space-4: 1.25rem;  /* 20px */
  --space-5: 1.5rem;   /* 24px */

  --font-family-main: 'Fredoka', Arial, Helvetica, sans-serif;
}

/* ===== CSS reset (minimal, no aggressive spacing overrides) ===== */
*, *::before, *::after { box-sizing: border-box; }
html { 
  /* On mobile: don't set height, let it grow naturally for scroll */
  /* On desktop: height 100% is ok */
  width: 100%;
  max-width: 100vw; /* Prevent overflow */
  /* NO overflow-x: hidden on html - can block vertical scroll in Chrome */
  /* This fix helps all pages, not just inspiratie */
}
/* Desktop: full height for layout */
@media (min-width: 768px) {
  html {
    height: 100%;
  }
}
body { 
  /* CRITICAL FIX: On mobile Chrome, height: 100% BLOCKS scroll */
  /* Use min-height instead so body can grow naturally */
  min-height: 100vh; /* Mobile: allows body to grow, enables scroll */
  min-height: 100dvh; /* Use dynamic viewport height for mobile Chrome */
  overflow-x: hidden; /* Prevent horizontal scroll on body only */
  /* Don't set overflow-y - let it flow naturally for vertical scroll */
  width: 100%;
  max-width: 100vw; /* Prevent overflow */
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-family-main);
  font-size: 1rem;      /* Reset from 1.25rem -> 1rem for better baseline */
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  position: relative;
}
/* Desktop: full height for layout */
@media (min-width: 768px) {
  body {
    height: 100%;
    min-height: 100vh; /* Fallback */
  }
}
img, picture, video, canvas, svg { 
  display: block; 
  max-width: 100%; 
  height: auto; 
}
/* Prevent overflow on all containers */
* {
  box-sizing: border-box;
}
/* Ensure containers don't overflow - but don't block vertical scroll */
.container, [class*="max-w"], [class*="container"] {
  max-width: 100%;
  overflow-x: hidden; /* Only block horizontal overflow */
  /* Don't set overflow-y - let it flow naturally for vertical scroll */
}

/* Chrome mobile scroll fix specifically for inspiratie pages */
[data-inspiratie-page] {
  /* On mobile: ensure page can scroll naturally */
  /* Don't set overflow-y: auto - let it flow naturally */
  overflow-x: hidden;
  /* Ensure body can grow beyond viewport on mobile */
  min-height: 100dvh;
}

/* Chrome mobile scroll fix for edit product/inspiration pages */
[data-edit-product-form] {
  /* On mobile: ensure page can scroll naturally in portrait mode */
  overflow-x: hidden;
  min-height: 100dvh; /* Dynamic viewport height for Chrome mobile */
}

/* Mobile-specific: prevent nested scroll containers from hijacking page scroll */
@media (max-width: 767px) {
  /* On mobile, nested overflow-x-auto containers should not block vertical scroll */
  [data-inspiratie-page] [class*="overflow-x-auto"],
  [data-edit-product-form] [class*="overflow-x-auto"] {
    /* Allow vertical scroll to pass through to page */
    touch-action: pan-y pinch-zoom;
    /* Prevent horizontal scroll from blocking vertical */
    overscroll-behavior-x: contain;
    overscroll-behavior-y: auto;
  }
  
  /* Portrait mode specific fixes for edit forms */
  @media (orientation: portrait) and (max-width: 767px) {
    /* Ensure edit forms can scroll in portrait mode */
    [data-edit-product-form] {
      /* Force scroll to work in portrait */
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    /* Modal form containers in portrait mode - CRITICAL FIX for Chrome */
    [data-recipe-form],
    [data-garden-form],
    [data-design-form] {
      /* Ensure scroll works in portrait mode */
      touch-action: pan-y pinch-zoom !important;
      overscroll-behavior: contain;
      overscroll-behavior-y: auto;
      /* Force Chrome to recognize scroll container */
      -webkit-overflow-scrolling: touch !important;
      overflow-y: auto !important;
      /* CRITICAL: Force explicit height in portrait mode to enable scroll */
      max-height: 100vh !important;
      max-height: 100dvh !important; /* Dynamic viewport height for mobile Chrome */
      height: 100vh !important;
      height: 100dvh !important;
      min-height: 0 !important;
      /* Remove any conflicting styles */
      position: relative !important;
    }
  }
}

/* Cross-browser text visibility fix - ensure text is always visible */
span, p, div {
  /* Prevent text from being hidden by browser optimizations */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Force text visibility on all browsers - especially for mobile */
.text-white {
  color: rgb(255, 255, 255) !important;
  -webkit-text-fill-color: rgb(255, 255, 255);
}

/* Fix for flex containers on mobile browsers */
.flex-col > * {
  min-width: 0;
  width: 100%;
}
input, button, textarea, select { font: inherit; }
a { color: inherit; text-decoration: none; }
ul, ol { padding: 0; margin: 0; list-style: none; }

/* IMPORTANT: No global gap/margin/padding rules here.
   Spacing must be applied locally with Tailwind (gap-x/y, space-x/y, p-*, m-*). */

/* ===== Tailwind base type scale ===== */
@layer base {
  h1 { @apply text-3xl md:text-4xl font-semibold tracking-tight; }
  h2 { @apply text-2xl md:text-3xl font-semibold tracking-tight; }
  h3 { @apply text-xl md:text-2xl font-semibold; }
  h4 { @apply text-lg md:text-xl font-semibold; }
  p  { @apply leading-relaxed; }
}

/* ===== Small helpers (opt-in) ===== */
@layer utilities {
  .content-wrap { @apply max-w-6xl mx-auto px-4 md:px-6; }
  .section    { @apply py-6 md:py-8; }
  .card       { @apply rounded-2xl bg-white shadow-sm border border-black/5; }
  .card-pad   { @apply p-4 md:p-6; }
}
